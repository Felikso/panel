{"version":3,"file":"uploader.js","sources":["uploader.js"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\njQuery(document).ready(function ($) {\n  /**\n  * Image upload \n  */\n  $('.mx_upload_image').on('click', function (e) {\n    var mx_upload_button = $(this);\n    e.preventDefault();\n    var frame;\n\n    if (frame) {\n      frame.open();\n      return;\n    }\n\n    frame = wp.media({\n      title: 'wybierz zdjÄ™cie',\n      library: {\n        type: 'image'\n      },\n      button: {\n        text: 'Upload'\n      },\n      multyple: false\n    });\n    frame.on('select', function () {\n      var attachment = frame.state().get('selection').first(); // and show the image's data\n\n      var image_id = attachment.id;\n      var image_url = attachment.attributes.url; // pace an id\n\n      mx_upload_button.parent().find('.mx_upload_image_save').val(image_id);\n      mx_upload_button.parent().find('.mx_save_img_field').val(image_id); // show an image\n\n      mx_upload_button.parent().find('.mx_upload_image_show').attr('src', image_url);\n      mx_upload_button.parent().find('.mx_upload_image_show').show(); // show \"remove button\"\n\n      mx_upload_button.parent().find('.mx_upload_image_remove').show(); // hide \"upload\" button\n\n      mx_upload_button.hide();\n    });\n    frame.open();\n  }); // remove image\n\n  $('.mx_upload_image_remove').on('click', function (e) {\n    var remove_button = $(this);\n    e.preventDefault(); // remove an id\n\n    remove_button.parent().find('.mx_upload_image_save').val(''); // hide an image\n\n    remove_button.parent().find('.mx_upload_image_show').attr('src', '');\n    remove_button.parent().find('.mx_upload_image_show').hide(); // show \"Upload button\"\n\n    remove_button.parent().find('.mx_upload_image').show(); // hide \"remove\" button\n\n    remove_button.hide();\n  });\n  /**\n  * Video upload\n  */\n\n  $('.mx_upload_video').on('click', function (e) {\n    var mx_upload_button = $(this);\n    e.preventDefault();\n    var frame;\n\n    if (frame) {\n      frame.open();\n      return;\n    }\n\n    frame = wp.media({\n      title: 'choose video',\n      library: {\n        type: 'video'\n      },\n      button: {\n        text: 'Upload'\n      },\n      multyple: false\n    });\n    frame.on('select', function () {\n      var attachment = frame.state().get('selection').first(); // and show the video's data\n\n      var video_id = attachment.id;\n      var video_url = attachment.attributes.url; // pace an id\n\n      mx_upload_button.parent().find('.mx_upload_video_save').val(video_id); // show an video\n\n      mx_upload_button.parent().find('.mx_upload_video_show').attr('src', video_url);\n      mx_upload_button.parent().find('.video-wrapper').show();\n      mx_upload_button.parent().find('.video-wrapper').load(); // show \"remove button\"\n\n      mx_upload_button.parent().find('.mx_upload_video_remove').show(); // hide \"upload\" button\n\n      mx_upload_button.hide();\n    });\n    frame.open();\n  }); // remove video\n\n  $('.mx_upload_video_remove').on('click', function (e) {\n    var remove_button = $(this);\n    e.preventDefault(); // remove an id\n\n    remove_button.parent().find('.mx_upload_video_save').val(''); // hide an video\n\n    remove_button.parent().find('.mx_upload_video_show').attr('src', '');\n    remove_button.parent().find('.video-wrapper').hide(); // show \"Upload button\"\n\n    remove_button.parent().find('.mx_upload_video').show(); // hide \"remove\" button\n\n    remove_button.hide();\n  });\n  /**\n  * Document upload\n  */\n\n  $('.mx_upload_document').on('click', function (e) {\n    var mx_upload_button = $(this);\n    e.preventDefault();\n    var frame;\n\n    if (frame) {\n      frame.open();\n      return;\n    }\n\n    frame = wp.media({\n      title: 'choose document',\n      library: {},\n      button: {\n        text: 'Upload'\n      },\n      multyple: false\n    });\n    frame.on('select', function () {\n      var attachment = frame.state().get('selection').first(); // and show the document's data\n\n      var document_id = attachment.id;\n      var document_url = attachment.attributes.url; // pace an id\n\n      mx_upload_button.parent().find('.mx_upload_document_save').val(document_id); // show an document\n\n      mx_upload_button.parent().find('.mx_upload_document_show').text(document_url);\n      mx_upload_button.parent().find('.mx_upload_document_show').show(); // show \"remove button\"\n\n      mx_upload_button.parent().find('.mx_upload_document_remove').show(); // hide \"upload\" button\n\n      mx_upload_button.hide();\n    });\n    frame.open();\n  }); // remove document\n\n  $('.mx_upload_document_remove').on('click', function (e) {\n    var remove_button = $(this);\n    e.preventDefault(); // remove an id\n\n    remove_button.parent().find('.mx_upload_document_save').val(''); // hide an document\n\n    remove_button.parent().find('.mx_upload_document_show').text('');\n    remove_button.parent().find('.mx_upload_document_show').hide(); // show \"Upload button\"\n\n    remove_button.parent().find('.mx_upload_document').show(); // hide \"remove\" button\n\n    remove_button.hide();\n  });\n});\n\nfunction addNewField(elem) {\n  var buttonIdStr = elem.id;\n  var splitingArray = buttonIdStr.split(\"_\");\n  var filteredArray = splitingArray.filter(function (e) {\n    return e !== \"\";\n  });\n  var elemPrefix = filteredArray[0];\n  var elemId = filteredArray[filteredArray.length - 1];\n  var elemPrefixSlicer = \"_\" + elemPrefix + \"_\";\n  var elemIdSlicer = \"_\" + elemId;\n  var parentIdStr = buttonIdStr.replace(elemPrefixSlicer, \"\").replace(elemIdSlicer, \"\");\n  var parentElem = elem.closest(\"#\" + parentIdStr);\n  var parentNodes = parentElem.querySelectorAll('[id*=' + parentIdStr + '');\n  parentNodes.forEach(function (currentValue, currentIndex, listObj) {\n    var node = parentNodes[currentIndex];\n\n    if (node.required && node.value === \"\") {\n      elem.preventDefault();\n    }\n  }, 'myThisArg');\n  var arrayIds = parentIdStr.match(/\\d+/g);\n  var newIdLength = arrayIds ? arrayIds.length : null;\n  var newId = arrayIds ? arrayIds[newIdLength] : null;\n  var elementsParentIdStr = arrayIds ? parentIdStr.substring(0, parentIdStr.length - newIdLength) : parentIdStr;\n  var elements = document.querySelectorAll('div[id^=' + elementsParentIdStr + '');\n  var div = document.getElementById(parentIdStr),\n      clone = div.cloneNode(true); // true means clone all childNodes and all event handlers\n\n  id = elements.length;\n  clone.id = elementsParentIdStr + \"\" + id;\n  elem.remove();\n  document.body.appendChild(clone);\n  var nodes = clone.querySelectorAll('[id*=' + parentIdStr + '');\n  nodes.forEach(function (currentValue, currentIndex, listObj) {\n    nodes[currentIndex].id = nodes[currentIndex].id.replace(parentIdStr, clone.id);\n\n    if (nodes[currentIndex].id == clone.id + \"_nonce_name\") {\n      nodes[currentIndex].value = nodes[currentIndex].value + \"\" + id;\n    } else {\n      nodes[currentIndex].value = \"\";\n    }\n  }, 'myThisArg');\n}\n/*\n* A custom function that checks if element is in array, we'll need it later\n*/\n\n\nfunction in_array(el, arr) {\n  for (var i in arr) {\n    if (arr[i] == el) return true;\n  }\n\n  return false;\n}\n\njQuery(function ($) {\n  /*\n   * Sortable images\n   */\n  $('ul.ventusweb_gallery_mtb').sortable({\n    items: 'li',\n    cursor: '-webkit-grabbing',\n\n    /* mouse cursor */\n    scrollSensitivity: 40,\n\n    /*\n    You can set your custom CSS styles while this element is dragging\n    start:function(event,ui){\n    \tui.item.css({'background-color':'grey'});\n    },\n    */\n    stop: function stop(event, ui) {\n      ui.item.removeAttr('style');\n      var sort = new Array(),\n\n      /* array of image IDs */\n      gallery = $(this);\n      /* ul.ventusweb_gallery_mtb */\n\n      /* each time after dragging we resort our array */\n\n      gallery.find('li').each(function (index) {\n        sort.push($(this).attr('data-id'));\n      });\n      /* add the array value to the hidden input field */\n\n      gallery.parent().next().val(sort.join());\n      /* console.log(sort); */\n    }\n  });\n  /*\n   * Multiple images uploader\n   */\n\n  $('.ventusweb_upload_gallery_button').click(function (e) {\n    /* on button click*/\n    e.preventDefault();\n    var button = $(this),\n        hiddenfield = button.prev(),\n        hiddenfieldvalue = hiddenfield.val().split(\",\"),\n\n    /* the array of added image IDs */\n    custom_uploader = wp.media({\n      title: 'Insert images',\n\n      /* popup title */\n      library: {\n        type: 'image'\n      },\n      button: {\n        text: 'Use these images'\n      },\n\n      /* \"Insert\" button text */\n      multiple: true\n    }).on('select', function () {\n      var attachments = custom_uploader.state().get('selection').map(function (a) {\n        a.toJSON();\n        return a;\n      }),\n          thesamepicture = false,\n          i;\n      /* loop through all the images */\n\n      for (i = 0; i < attachments.length; ++i) {\n        /* if you don't want the same images to be added multiple time */\n        if (!in_array(attachments[i].id, hiddenfieldvalue)) {\n          /* add HTML element with an image */\n          $('ul.ventusweb_gallery_mtb').append('<li data-id=\"' + attachments[i].id + '\"><img src=\"' + attachments[i].attributes.url + '\"><a href=\"#\" class=\"ventusweb_gallery_remove\" style=\"width: 300px;\">&times;</a></li>');\n          /* add an image ID to the array of all images */\n\n          hiddenfieldvalue.push(attachments[i].id);\n        } else {\n          thesamepicture = true;\n        }\n      }\n      /* refresh sortable */\n\n\n      $(\"ul.ventusweb_gallery_mtb\").sortable(\"refresh\");\n      /* add the IDs to the hidden field value */\n\n      hiddenfield.val(hiddenfieldvalue.join());\n      /* you can print a message for users if you want to let you know about the same images */\n\n      if (thesamepicture == true) alert('The same images are not allowed.');\n    }).open();\n  });\n  /*\n   * Remove certain images\n   */\n\n  $('body').on('click', '.ventusweb_gallery_remove', function () {\n    var id = $(this).parent().attr('data-id'),\n        gallery = $(this).parent().parent(),\n        hiddenfield = gallery.parent().next(),\n        hiddenfieldvalue = hiddenfield.val().split(\",\"),\n        i = hiddenfieldvalue.indexOf(id);\n    $(this).parent().remove();\n    /* remove certain array element */\n\n    if (i != -1) {\n      hiddenfieldvalue.splice(i, 1);\n    }\n    /* add the IDs to the hidden field value */\n\n\n    hiddenfield.val(hiddenfieldvalue.join());\n    /* refresh sortable */\n\n    gallery.sortable(\"refresh\");\n    return false;\n  });\n  /*\n   * Selected item\n   */\n\n  $('body').on('mousedown', 'ul.ventusweb_gallery_mtb li', function () {\n    var el = $(this);\n    el.parent().find('li').removeClass('ventusweb-active');\n    el.addClass('ventusweb-active');\n  });\n});\n\n},{}]},{},[1]);\n"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","jQuery","document","ready","$","on","frame","mx_upload_button","this","preventDefault","wp","media","title","library","type","button","text","multyple","attachment","state","get","first","image_id","id","image_url","attributes","url","parent","find","val","attr","show","hide","open","remove_button","video_id","video_url","load","document_id","document_url","sortable","items","cursor","scrollSensitivity","stop","event","ui","item","removeAttr","sort","Array","gallery","each","index","push","next","join","click","hiddenfield","prev","hiddenfieldvalue","split","custom_uploader","multiple","attachments","map","toJSON","thesamepicture","el","arr","in_array","append","alert","indexOf","remove","splice","removeClass","addClass"],"mappings":"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"}