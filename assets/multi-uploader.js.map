{"version":3,"file":"multi-uploader.js","sources":["multi-uploader.js"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\n/*\r\n * A custom function that checks if element is in array, we'll need it later\r\n */\nfunction in_array(el, arr) {\n  for (var i in arr) {\n    if (arr[i] == el) return true;\n  }\n\n  return false;\n}\n\njQuery(function ($) {\n  /*\r\n   * Sortable images\r\n   */\n  $('ul.misha_gallery_mtb').sortable({\n    items: 'li',\n    cursor: '-webkit-grabbing',\n\n    /* mouse cursor */\n    scrollSensitivity: 40,\n\n    /*\r\n    You can set your custom CSS styles while this element is dragging\r\n    start:function(event,ui){\r\n    \tui.item.css({'background-color':'grey'});\r\n    },\r\n    */\n    stop: function stop(event, ui) {\n      ui.item.removeAttr('style');\n      var sort = new Array(),\n\n      /* array of image IDs */\n      gallery = $(this);\n      /* ul.misha_gallery_mtb */\n\n      /* each time after dragging we resort our array */\n\n      gallery.find('li').each(function (index) {\n        sort.push($(this).attr('data-id'));\n      });\n      /* add the array value to the hidden input field */\n\n      gallery.parent().next().val(sort.join());\n      /* console.log(sort); */\n    }\n  });\n  /*\r\n   * Multiple images uploader\r\n   */\n\n  $('.misha_upload_gallery_button').click(function (e) {\n    /* on button click*/\n    e.preventDefault();\n    var button = $(this),\n        hiddenfield = button.prev(),\n        hiddenfieldvalue = hiddenfield.val().split(\",\"),\n\n    /* the array of added image IDs */\n    custom_uploader = wp.media({\n      title: 'Insert images',\n\n      /* popup title */\n      library: {\n        type: 'image'\n      },\n      button: {\n        text: 'Use these images'\n      },\n\n      /* \"Insert\" button text */\n      multiple: true\n    }).on('select', function () {\n      var attachments = custom_uploader.state().get('selection').map(function (a) {\n        a.toJSON();\n        return a;\n      }),\n          thesamepicture = false,\n          i;\n      /* loop through all the images */\n\n      for (i = 0; i < attachments.length; ++i) {\n        /* if you don't want the same images to be added multiple time */\n        if (!in_array(attachments[i].id, hiddenfieldvalue)) {\n          /* add HTML element with an image */\n          $('ul.misha_gallery_mtb').append('<li data-id=\"' + attachments[i].id + '\"><span style=\"background-image:url(' + attachments[i].attributes.url + ')\"></span><a href=\"#\" class=\"misha_gallery_remove\">&times;</a></li>');\n          /* add an image ID to the array of all images */\n\n          hiddenfieldvalue.push(attachments[i].id);\n        } else {\n          thesamepicture = true;\n        }\n      }\n      /* refresh sortable */\n\n\n      $(\"ul.misha_gallery_mtb\").sortable(\"refresh\");\n      /* add the IDs to the hidden field value */\n\n      hiddenfield.val(hiddenfieldvalue.join());\n      /* you can print a message for users if you want to let you know about the same images */\n\n      if (thesamepicture == true) alert('The same images are not allowed.');\n    }).open();\n  });\n  /*\r\n   * Remove certain images\r\n   */\n\n  $('body').on('click', '.misha_gallery_remove', function () {\n    var id = $(this).parent().attr('data-id'),\n        gallery = $(this).parent().parent(),\n        hiddenfield = gallery.parent().next(),\n        hiddenfieldvalue = hiddenfield.val().split(\",\"),\n        i = hiddenfieldvalue.indexOf(id);\n    $(this).parent().remove();\n    /* remove certain array element */\n\n    if (i != -1) {\n      hiddenfieldvalue.splice(i, 1);\n    }\n    /* add the IDs to the hidden field value */\n\n\n    hiddenfield.val(hiddenfieldvalue.join());\n    /* refresh sortable */\n\n    gallery.sortable(\"refresh\");\n    return false;\n  });\n  /*\r\n   * Selected item\r\n   */\n\n  $('body').on('mousedown', 'ul.misha_gallery_mtb li', function () {\n    var el = $(this);\n    el.parent().find('li').removeClass('misha-active');\n    el.addClass('misha-active');\n  });\n});\n\n},{}]},{},[1]);\n"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","jQuery","$","sortable","items","cursor","scrollSensitivity","stop","event","ui","item","removeAttr","sort","Array","gallery","this","find","each","index","push","attr","parent","next","val","join","click","preventDefault","hiddenfield","prev","hiddenfieldvalue","split","custom_uploader","wp","media","title","library","type","button","text","multiple","on","attachments","state","get","map","toJSON","thesamepicture","el","arr","in_array","id","append","attributes","url","alert","open","indexOf","remove","splice","removeClass","addClass"],"mappings":"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"}