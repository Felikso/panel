!function o(i,a,l){function r(e,t){if(!a[e]){if(!i[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(_)return _(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=a[e]={exports:{}},i[e][0].call(n.exports,function(t){return r(i[e][1][t]||t)},n,n.exports,o,i,a,l)}return a[e].exports}for(var _="function"==typeof require&&require,t=0;t<l.length;t++)r(l[t]);return r}({1:[function(t,e,n){"use strict";function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,i,a=[],l=!0,r=!1;try{for(n=n.call(t);!(l=(o=n.next()).done)&&(a.push(o.value),!e||a.length!==e);l=!0);}catch(t){r=!0,i=t}finally{try{l||null==n.return||n.return()}finally{if(r)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}Vue.component("mx_multibox_element_saved",{props:{attrs:{type:Object,required:!0},block_name:{type:String,required:!0},element_id:{type:Number,required:!0},number_of_elements:{type:Number,required:!0}},template:'\n\n\t\t<div \n\t\t\tclass="mx_multibox_element"\n\t\t\t:class="\'mx_element_\' + element_id">\n\n\t\t\t<div\n\t\t\t\tv-for="(input, index) in attrs"\n\t\t\t>\n\n\t\t\t\t<div\n\t\t\t\t\tv-if="inputs_types.indexOf( input.input_type ) != -1"\n\t\t\t\t>\n\t\t\t\t\t<component \n\t\t\t\t\t\t:is="\'mx_\' + input.input_type"\n\t\t\t\t\t\t:label="input.label"\n\t\t\t\t\t\t:type="input.input_type"\n\t\t\t\t\t\t:value="input.value"\n\t\t\t\t\t\t:block_name="block_name"\n\t\t\t\t\t\t:element_id="parseInt( element_id )"\n\t\t\t\t\t\t:input_id="parseInt( index )"\n\n\t\t\t\t\t\t@input_data="push_input_data"\n\t\t\t\t\t></component>\n\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\n\t\t\t\t\t<h3>The "{{ input.input_type }}" type doesn\'t exists!</h3>\n\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<button\n\t\t\t\tv-if="number_of_elements > 1"\n\t\t\t\t@click.prevent="remove_element"\n\t\t\t>Del</button>\n\n\t\t</div>\n\t\t',data:function(){return{inputs_types:["input-text","textarea"],inputs:[],element_data:{}}},methods:{remove_element:function(){var t={block_name:this.block_name,element_id:this.element_id};this.$emit("delete_element",t)},push_input_data:function(o){var i=this;this.inputs.forEach(function(t,e){var n="mx_input"+o.input_id;Object.keys(i.inputs[e])[0]===n&&(i.inputs[e][n]=o.value)}),this.element_data[o.input_id]=o,this.$emit("element_data",this.element_data)},check_inputs_filed_in:function(){var o=this,i=!0;return this.inputs.forEach(function(t,e){var n=Object.keys(o.inputs[e]);o.inputs[e][n]||(i=!1)}),i}},watch:{inputs:{handler:function(t){var e=this.check_inputs_filed_in();this.$emit("add_new_element",e)},deep:!0}},mounted:function(){for(var t,e=0,n=Object.entries(this.attrs);e<n.length;e++){var o=p(n[e],2),i=o[0],i=(o[1],t=null,(o="mx_input"+i)in(i={})?Object.defineProperty(i,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[o]=t,i);this.inputs.push(i)}}}),Vue.component("mx_multibox_block_saved",{props:{block:{type:Object,required:!0},block_name:{type:String,required:!0},section_names:{type:Object,required:!0}},template:'\n\t\t\t<div class="mx_multibox_block mx-multibox_wrap">\n\n\t\t\t\t<h3>{{ section_names[block_name] }}</h3>\n\n\t\t\t\t<mx_multibox_element_saved\n\n\t\t\t\t\tv-for="element in number_of_elements"\n\t\t\t\t\t:attrs="set_attrs( block[element] )"\n\t\t\t\t\t:block_name="block_name"\n\t\t\t\t\t:element_id="element"\n\t\t\t\t\t:key="element"\n\t\t\t\t\t:number_of_elements="number_of_elements"\n\t\t\t\t\t@add_new_element="add_new_element"\n\t\t\t\t\t@element_data="push_element_data"\n\n\t\t\t\t\t@delete_element="remove_element"\n\n\t\t\t\t></mx_multibox_element_saved>\t\t\t\t\n\n\t\t\t\t<button\n\t\t\t\t\tclass="mx-add-block"\n\t\t\t\t\t@click.prevent="add_element"\n\t\t\t\t\tv-if="add_new"\n\t\t\t\t>Add</button>\n\n\t\t\t</div>\n\t\t',data:function(){return{number_of_elements:1,add_new:!1,block_patern:{},block_data:{}}},methods:{remove_element:function(t){this.$emit("delete_element",t)},set_attrs:function(t){return t||this.block_patern},_obj_size:function(t){var e,n=0;for(e in t)t.hasOwnProperty(e)&&n++;return n},push_element_data:function(t){for(var e=0,n=Object.entries(t);e<n.length;e++){var o=p(n[e],2),o=(o[0],o[1]);"object"!==d(this.block_data[o.block_name])&&(this.block_data[o.block_name]={}),this.block_data[o.block_name][o.element_id]=t}this.$emit("block_data",this.block_data)},add_new_element:function(t){this.add_new=t},add_element:function(){this.set_block_patern(),this.number_of_elements+=1,this.$emit("add_element_to_block",this.block_data,this.block_name)},set_number_of_elements:function(){this.number_of_elements=this._obj_size(this.block)},set_block_patern:function(){if(0===Object.keys(this.block_patern).length)for(var t=0,e=Object.entries(this.block[1]);t<e.length;t++){var n=p(e[t],2),o=n[0],n=n[1];this.block_patern[o]={},this.block_patern[o].value="",this.block_patern[o].input_type=n.input_type,this.block_patern[o].label=n.label}}},mounted:function(){this.set_number_of_elements(),this.set_block_patern()}}),null!==document.getElementById("mx_multibox_saved")&&new Vue({el:"#mx_multibox_saved",data:{errors:[],blocks:{},time_out:null,time_out_main_block:null,time_out_output_block:null,save_data_input_id:mx_metabox_id,blocks_output_data:{},get_data_from_db:mx_serialized_data,incr:0,section_names:{}},methods:{add_element_to_block:function(t,e){this.blocks[e]=t[e]},remove_element:function(t){delete this.blocks[t.block_name][t.element_id];for(var e=this,n=0,o=Object.entries(this.blocks[t.block_name]);n<o.length;n++){var i=p(o[n],2),a=i[0],i=i[1];a>t.element_id&&(delete e.blocks[t.block_name][a],e.blocks[t.block_name][a-1]=i)}var l=e.blocks[t.block_name];e.blocks[t.block_name]={},e.blocks_output_data[t.block_name]={},setTimeout(function(){e.incr+=1,e.blocks[t.block_name]=l},100)},save_data:function(t){var e=this;this.save_data_into_main_block(t),this.save_data_into_output_block(t),clearTimeout(this.time_out),this.time_out=setTimeout(function(){var t={action:"mx_convert_multibox",nonce:mx_multibox_localize.nonce,data:e.blocks_output_data,section_names:e.section_names};jQuery.post(mx_multibox_localize.ajax_url,t,function(t){jQuery("#"+e.save_data_input_id).val(t)})},700)},save_data_into_main_block:function(l){var _=this;clearTimeout(this.time_out_main_block),this.time_out_main_block=setTimeout(function(){console.log("save data into main block");for(var t=0,e=Object.entries(_.blocks);t<e.length;t++)for(var n=p(e[t],2),o=n[0],i=(n[1],0),a=Object.entries(l);i<a.length;i++)!function(){var t=p(a[i],2),l=t[0],r=t[1];o===l&&Object.keys(r).forEach(function(t,e){for(var n=0,o=Object.entries(r[t]);n<o.length;n++){var i=p(o[n],2),a=i[0];i[1];_.blocks[l][t][a].value!==r[t][a].value&&(_.blocks[l][t][a].value=r[t][a].value)}})}()},400)},save_data_into_output_block:function(m){var b=this;clearTimeout(this.time_out_output_block),this.time_out_output_block=setTimeout(function(){console.log("save data into output block");for(var t=0,e=Object.entries(m);t<e.length;t++){var n=p(e[t],2),o=n[0],n=n[1];if("object"!==d(b.blocks_output_data[o])){b.blocks_output_data[o]={};for(var i=0,a=Object.entries(n);i<a.length;i++){var l=p(a[i],2),r=l[0],l=l[1];b.blocks_output_data[o][r]=l}}else for(var _=0,u=Object.entries(n);_<u.length;_++){var s=p(u[_],2),c=s[0],s=s[1];b.blocks_output_data[o][c]=s}}},400)},get_saved_data:function(){var e;this.get_data_from_db&&(e=this,setTimeout(function(){var t={action:"mx_decode_multibox",nonce:mx_multibox_localize.nonce,data:e.get_data_from_db};jQuery.post(mx_multibox_localize.ajax_url,t,function(t){e.isJSON(t)?(t=JSON.parse(t),e.section_names=t.section_names,e.blocks=t.blocks):e.errors.push("JSON.pars error!")})},1e3))},isJSON:function(t){try{JSON.parse(t)}catch(t){return!1}return!0}},mounted:function(){this.get_saved_data()}})},{}]},{},[1]);
//# sourceMappingURL=vue-custom-saved.js.map
